{% extends "tpl.html" %}

{% block head %}
    <script src="/js/prototype.js"></script>
    <script src="/js/map.js"></script>
{% endblock %}

{% block main %}
			<h2>{{city.name}}</h2>
			<map id="map">
				{% for row in map %}
                {%if loop.first%}
                    <tr><h></h>{%for c in row%}
                        <h>{{loop.index0 - city.x}}</h>
                    {%endfor%}</tr>
                {%endif%}
				<r><h>{{city.y - loop.index0}}</h>
                    {%for c in row -%}
                        <{% if c.z == "-1" -%}e{%-
                        elif c.city -%}c{%-
                        elif c.building -%}x{%-
                        elif c.dried -%}d{%-
                        else-%}v{%-endif-%} 
                        {%- if c.items %} 
                        data-items="{{c.items|json(0)}}"{%-endif%}></{%
                        if c.z == "-1" -%}e{%-
                        elif c.city -%}c{%-
                        elif c.building -%}x{%-
                        elif c.dried -%}d{%-
                        else-%}v{%-endif%}>
                    {% endfor%}<h>{{city.y - loop.index0}}</h></r>
                {%if loop.last%}
                    <tr><h></h>{%for c in row%}
                        <h>{{loop.index0 - city.x}}</h>
                    {%endfor%}</tr>
                {%endif%}
				{%endfor%}
			</map>
            {%for cat,items in comp%}
                <h3>{{cat}}</h3>
                <ul>{%for item in items%}
                    <li>{{item.count}}× {{item.name}}
                    {%if item.broken%}<em>Cassé</em>{%endif%}
                    [{{city.x-item.x}}/{{city.y-item.y}}]
                    </li>
                {%endfor%}</ul>
            {%endfor%}


{% endblock main %}

