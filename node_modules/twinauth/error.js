// error.js

var known_error = {
	"login required": "This section require access to your twinoid API. "
        +"You can connect you account using the new account button in the"
        +"	bar at the top.",
	"wip": "Work in Progress. Come back later."
}
	

this.OAuth = function OAuth(message){
	this.constructor.prototype.__proto__ = Error.prototype
	Error.captureStackTrace(this, this.constructor)
	this.name = this.constructor.name
	this.message = message
}
this.Unauthorized = function Unauthorized(message){
	this.constructor.prototype.__proto__ = Error.prototype
	Error.captureStackTrace(this, this.constructor)
	this.name = this.constructor.name
	this.message = message
	this.number = 401
}

function err_gotcha(err, req, res, next){
	if(!known_error.hasOwnProperty(err.message)) next(err)
	res.render("error.html", 
			{error: err, error_message: known_error[err.message]})
}
function err_generic(err, req, res, next){
	res.render("error.html", {error: err})
}

this.setup = function setup(app){
	app.use(err_gotcha)
	app.use(err_generic)
}
